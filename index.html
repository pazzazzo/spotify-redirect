<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Redirection‚Ä¶</title>
    <script>
        (function () {
            // 1) On cr√©e un objet URLSearchParams √† partir de la query string
            const params = new URLSearchParams(window.location.search);

            // 2) On r√©cup√®re la cible
            const target = params.get('code');
            if (!target) {
                document.onload = () => {
                    document.body.textContent = '‚ùå Param√®tre "code" manquant.';
                }
                return;
            }

            // 3) On supprime "code" et on reconstruit les autres param√®tres
            params.delete('code');
            const rest = params.toString(); // ex: "state=192.168.0.13&foo=bar"

            // 4) On choisit le s√©parateur correct (?) ou (&)
            const sep = target.includes('?') ? '&' : '?';

            // 5) On forme l‚ÄôURL finale
            const finalUrl = rest ? `${target}${sep}${rest}` : target;
            console.log(finalUrl);

            // 6) On remplace la page courante par la cible
            window.location.replace(finalUrl);
        })();
    </script>
</head>

<body>
    <p>üîÑ Redirection en cours‚Ä¶ Si rien ne se passe, <a id="link">cliquez ici</a>.</p>
    <script>
        // en cas de JS d√©sactiv√© ou lenteur, on met √† jour le lien
        const fallback = document.getElementById('link');
        const params = new URLSearchParams(window.location.search);
        const target = params.get('code') || '#';
        params.delete('code');
        const rest = params.toString();
        const sep = target.includes('?') ? '&' : '?';
        fallback.href = rest ? `${target}${sep}${rest}` : target;
    </script>
</body>

</html>